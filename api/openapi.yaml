openapi: 3.0.1

#
#            ╓███,
#          ▄██▀"███▄
#         ╚█▀    `▀██▄
#     ,,     ╓███,  ▀██▌_
#   ╓███   ▄██▀"███▄  ╙███_
#  ▐██"  ▄██▀    `▀██▄  ╙██
#  ▐██  ╙██▄       ╫██Γ  ██─
#  ▐██    ▀██▄  ,▓██▀    ██─
#  ▐██      ╙█████▀      ██─
#  ▐██      ╓█████_      ██─
#  ▐██    ▄██▀` ╙███╥    ██─
#  └███████▀      `▀██   ██
#

info:
  contact:
    name: Barnaby Keene
  description: Storyden social API for building community driven platforms.
  title: storyden
  version: "1"

servers:
  - url: "/api"
    description: |
      The HTTP interface that this document describes is mounted on the `/api` 
      path and any requests outside of this base path will be proxied to the
      frontend if Storyden is running in standalone mode.

security:
  - browser: []

tags:
  - name: misc
    description: Non-business logic stuff.
  - name: auth
    description: Authentication resources.
  - name: accounts
    description: User accounts.
  - name: profiles
    description: Public profiles.
  - name: categories
    description: Thread categories.
  - name: threads
    description: Forum threads.
  - name: posts
    description: Posts within a specific thread.

#
# 8888888b.     d8888 88888888888 888    888  .d8888b.
# 888   Y88b   d88888     888     888    888 d88P  Y88b
# 888    888  d88P888     888     888    888 Y88b.
# 888   d88P d88P 888     888     8888888888  "Y888b.
# 8888888P" d88P  888     888     888    888     "Y88b.
# 888      d88P   888     888     888    888       "888
# 888     d8888888888     888     888    888 Y88b  d88P
# 888    d88P     888     888     888    888  "Y8888P"
#

paths:
  #
  #                d8b
  #                Y8P
  #
  #  88888b.d88b.  888 .d8888b   .d8888b
  #  888 "888 "88b 888 88K      d88P"
  #  888  888  888 888 "Y8888b. 888
  #  888  888  888 888      X88 Y88b.
  #  888  888  888 888  88888P'  "Y8888P
  #

  /version:
    get:
      operationId: GetVersion
      summary: Get the software version string.
      description: |
        The version number includes the date and time of the release build as
        well as a short representation of the Git commit hash.
      security: []
      tags: [misc]
      responses:
        "200":
          description: OK
          content:
            text/plain:
              schema:
                type: string

  /openapi.json:
    get:
      operationId: GetSpec
      summary: Get the OpenAPI 3.0 specification as JSON.
      description: |
        Note: the generator creates a `map[string]interface{}` if this is set to
        `application/json`... so I'm just using plain text for now.

      security: []
      tags: [misc]
      responses:
        "200":
          description: OK
          content:
            text/plain:
              schema:
                type: string

  /v1/info:
    get:
      operationId: GetInfo
      description: |
        Get the basic forum installation info such as title, description, etc.
      security: []
      tags: [misc]
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "200": { $ref: "#/components/responses/GetInfoOK" }

  #
  #                   888    888
  #                   888    888
  #                   888    888
  #  8888b.  888  888 888888 88888b.
  #     "88b 888  888 888    888 "88b
  # .d888888 888  888 888    888  888
  # 888  888 Y88b 888 Y88b.  888  888
  # "Y888888  "Y88888  "Y888 888  888
  #

  /v1/auth:
    get:
      operationId: AuthProviderList
      description: |
        Retrieve a list of authentication providers. Storyden supports a few 
        ways to authenticate, from simple passwords to OAuth and WebAuthn. This
        endpoint tells a client which auth capabilities are enabled.
      tags: [auth]
      security: []
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "200": { $ref: "#/components/responses/AuthProviderListOK" }

  /v1/auth/password/signup:
    post:
      operationId: AuthPasswordSignup
      description: Register a new account with a username and password.
      tags: [auth]
      security: []
      requestBody: { $ref: "#/components/requestBodies/AuthPassword" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "200": { $ref: "#/components/responses/AuthSuccessOK" }

  /v1/auth/password/signin:
    post:
      operationId: AuthPasswordSignin
      description: Sign in to an existing account with a username and password.
      tags: [auth]
      security: []
      requestBody: { $ref: "#/components/requestBodies/AuthPassword" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/AuthSuccessOK" }

  /v1/auth/oauth/{oauth_provider}/callback:
    post:
      operationId: OAuthProviderCallback
      description: Sign in to an existing account with a username and password.
      tags: [auth]
      security: []
      parameters: [$ref: "#/components/parameters/OAuthProvider"]
      requestBody: { $ref: "#/components/requestBodies/OAuthProviderCallback" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "404": { $ref: "#/components/responses/NotFound" }
        "200": { $ref: "#/components/responses/AuthSuccessOK" }

  /v1/auth/webauthn/make/{account_handle}:
    get:
      operationId: WebAuthnRequestCredential
      description: |
        Start the WebAuthn registration process by requesting a credential.
      tags: [auth]
      security: []
      parameters: [$ref: "#/components/parameters/AccountHandleParam"]
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "200": { $ref: "#/components/responses/WebAuthnRequestCredentialOK" }

  /v1/auth/webauthn/make:
    post:
      operationId: WebAuthnMakeCredential
      description: Complete WebAuthn registration by creating a new credential.
      tags: [auth]
      security: [webauthn: []]
      requestBody: { $ref: "#/components/requestBodies/WebAuthnMakeCredential" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "200": { $ref: "#/components/responses/AuthSuccessOK" }

  /v1/auth/webauthn/assert/{account_handle}:
    get:
      operationId: WebAuthnGetAssertion
      description: Start the WebAuthn assertion for an existing account.
      tags: [auth]
      security: []
      parameters: [$ref: "#/components/parameters/AccountHandleParam"]
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200":
          $ref: "#/components/responses/WebAuthnGetAssertionOK"

  /v1/auth/webauthn/assert:
    post:
      operationId: WebAuthnMakeAssertion
      description: Complete the credential assertion and sign in to an account.
      tags: [auth]
      security: [webauthn: []]
      requestBody: { $ref: "#/components/requestBodies/WebAuthnMakeAssertion" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/AuthSuccessOK" }

  /v1/auth/phone:
    post:
      operationId: PhoneRequestCode
      description: |
        Start the authentication flow with a phone number. The handler will send
        a one-time code to the provided phone number which must then be sent to
        the other phone endpoint to verify the number and validate the account.
      tags: [auth]
      security: []
      requestBody: { $ref: "#/components/requestBodies/PhoneRequestCode" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "200": { $ref: "#/components/responses/AuthSuccessOK" }

  /v1/auth/phone/{account_handle}:
    put:
      operationId: PhoneSubmitCode
      description: |
        Complete the phone number authentication flow by submitting the one-time
        code that was sent to the user's phone.
      tags: [auth]
      security: []
      parameters: [$ref: "#/components/parameters/AccountHandleParam"]
      requestBody: { $ref: "#/components/requestBodies/PhoneSubmitCode" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "200": { $ref: "#/components/responses/AuthSuccessOK" }

  /v1/auth/logout:
    get:
      operationId: AuthProviderLogout
      description: Remove cookies from requesting client.
      tags: [auth]
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "200":
          description: OK
          headers: { Set-Cookie: { schema: { type: string } } }

  #
  #                                                      888
  #                                                      888
  #                                                      888
  #   8888b.   .d8888b .d8888b .d88b.  888  888 88888b.  888888 .d8888b
  #      "88b d88P"   d88P"   d88""88b 888  888 888 "88b 888    88K
  #  .d888888 888     888     888  888 888  888 888  888 888    "Y8888b.
  #  888  888 Y88b.   Y88b.   Y88..88P Y88b 888 888  888 Y88b.       X88
  #  "Y888888  "Y8888P "Y8888P "Y88P"   "Y88888 888  888  "Y888  88888P'
  #

  /v1/accounts:
    get:
      operationId: AccountGet
      description: Get the information for the currently authenticated account.
      tags: [accounts]
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/AccountGetOK" }

    patch:
      operationId: AccountUpdate
      description: Update the information for the currently authenticated account.
      tags: [accounts]
      requestBody: { $ref: "#/components/requestBodies/AccountUpdate" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/AccountUpdateOK" }

  /v1/accounts/self/avatar:
    post:
      operationId: AccountSetAvatar
      description: Upload an avatar for the authenticated account.
      tags: [accounts]
      requestBody: { $ref: "#/components/requestBodies/AccountSetAvatar" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { description: "OK" }

  /v1/accounts/{account_handle}/avatar:
    get:
      operationId: AccountGetAvatar
      description: Get an avatar for the specified account.
      tags: [accounts]
      security: []
      parameters: [$ref: "#/components/parameters/AccountHandleParam"]
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/AccountGetAvatar" }

  #
  #                           .d888 d8b 888
  #                          d88P"  Y8P 888
  #                          888        888
  # 88888b.  888d888 .d88b.  888888 888 888  .d88b.  .d8888b
  # 888 "88b 888P"  d88""88b 888    888 888 d8P  Y8b 88K
  # 888  888 888    888  888 888    888 888 88888888 "Y8888b.
  # 888 d88P 888    Y88..88P 888    888 888 Y8b.          X88
  # 88888P"  888     "Y88P"  888    888 888  "Y8888   88888P'
  # 888
  # 888
  # 888
  #

  /v1/profiles/{account_handle}:
    get:
      operationId: ProfileGet
      description: Get a public profile by ID.
      tags: [profiles]
      security: []
      parameters: [$ref: "#/components/parameters/AccountHandleParam"]
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/ProfileGetOK" }

  #
  #                   888                                      d8b
  #                   888                                      Y8P
  #                   888
  #  .d8888b  8888b.  888888 .d88b.   .d88b.   .d88b.  888d888 888  .d88b.  .d8888b
  # d88P"        "88b 888   d8P  Y8b d88P"88b d88""88b 888P"   888 d8P  Y8b 88K
  # 888      .d888888 888   88888888 888  888 888  888 888     888 88888888 "Y8888b.
  # Y88b.    888  888 Y88b. Y8b.     Y88b 888 Y88..88P 888     888 Y8b.          X88
  #  "Y8888P "Y888888  "Y888 "Y8888   "Y88888  "Y88P"  888     888  "Y8888   88888P'
  #                                       888
  #                                  Y8b d88P
  #                                   "Y88P"
  #

  /v1/categories:
    get:
      operationId: CategoryList
      description: Get a list of all categories on the site.
      security: []
      tags: [categories]
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "200": { $ref: "#/components/responses/CategoryListOK" }

  #
  # 888    888                                    888
  # 888    888                                    888
  # 888    888                                    888
  # 888888 88888b.  888d888 .d88b.   8888b.   .d88888 .d8888b
  # 888    888 "88b 888P"  d8P  Y8b     "88b d88" 888 88K
  # 888    888  888 888    88888888 .d888888 888  888 "Y8888b.
  # Y88b.  888  888 888    Y8b.     888  888 Y88b 888      X88
  #  "Y888 888  888 888     "Y8888  "Y888888  "Y88888  88888P'
  #

  /v1/threads:
    post:
      operationId: ThreadCreate
      description: Create a new thread within the specified category.
      tags: [threads]
      requestBody: { $ref: "#/components/requestBodies/ThreadCreate" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/ThreadCreateOK" }

    get:
      operationId: ThreadList
      description: Get a list of all threads.
      tags: [threads]
      security: []
      parameters:
        - name: author
          description: Show only results creeated by this user.
          required: false
          in: query
          schema: { $ref: "#/components/schemas/AccountHandle" }
        - name: tags
          description: Show only results with these tags
          required: false
          in: query
          schema: { $ref: "#/components/schemas/TagListIDs" }
        - name: categories
          description: Show only results with these categories
          required: false
          in: query
          schema: { $ref: "#/components/schemas/CategoryNameList" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/ThreadListOK" }

  /v1/threads/{thread_mark}:
    get:
      operationId: ThreadGet
      summary: Get information about a thread and the posts within the thread.
      description: |
        Get information about a thread such as its title, author, when it was
        created as well as a list of the posts within the thread.
      security: []
      tags: [threads]
      parameters: [$ref: "#/components/parameters/ThreadMarkParam"]
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/ThreadGet" }
    patch:
      operationId: ThreadUpdate
      description: Publish changes to a thread.
      tags: [threads]
      parameters: [$ref: "#/components/parameters/ThreadMarkParam"]
      requestBody: { $ref: "#/components/requestBodies/ThreadUpdate" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/ThreadUpdateOK" }
    delete:
      operationId: ThreadDelete
      description: Archive a thread using soft-delete.
      tags: [threads]
      parameters: [$ref: "#/components/parameters/ThreadMarkParam"]
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { description: OK }

  #
  #                             888
  #                             888
  #                             888
  #  88888b.   .d88b.  .d8888b  888888 .d8888b
  #  888 "88b d88""88b 88K      888    88K
  #  888  888 888  888 "Y8888b. 888    "Y8888b.
  #  888 d88P Y88..88P      X88 Y88b.       X88
  #  88888P"   "Y88P"   88888P'  "Y888  88888P'
  #  888
  #  888
  #  888
  #

  /v1/threads/{thread_mark}/posts:
    post:
      operationId: PostCreate
      description: Create a new post within a thread.
      tags: [posts]
      parameters: [$ref: "#/components/parameters/ThreadMarkParam"]
      requestBody: { $ref: "#/components/requestBodies/PostCreate" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/PostCreateOK" }

  /v1/posts/{post_id}:
    patch:
      operationId: PostUpdate
      description: Publish changes to a single post.
      tags: [posts]
      parameters: [$ref: "#/components/parameters/PostIDParam"]
      requestBody: { $ref: "#/components/requestBodies/PostUpdate" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/PostUpdateOK" }
    delete:
      operationId: PostDelete
      description: Archive a post using soft-delete.
      tags: [posts]
      parameters: [$ref: "#/components/parameters/PostIDParam"]
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { description: OK }

  /v1/posts/search:
    get:
      operationId: PostSearch
      description: Search through posts using various queries and filters.
      tags: [posts]
      security: []
      parameters:
        - name: body
          description: A text query to search for in post content.
          required: false
          in: query
          schema: { type: string }
        - name: author
          description: Show only results created by this account.
          required: false
          in: query
          schema: { $ref: "#/components/schemas/AccountHandle" }
        - name: kind
          description: Posts, threads or both.
          required: false
          in: query
          schema: { $ref: "#/components/schemas/ContentKinds" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/PostSearchOK" }

  /v1/posts/{post_id}/reacts:
    put:
      operationId: PostReactAdd
      description: Add a reaction to a post.
      tags: [posts]
      parameters: [$ref: "#/components/parameters/PostIDParam"]
      requestBody: { $ref: "#/components/requestBodies/PostReactAdd" }
      responses:
        default: { $ref: "#/components/responses/InternalServerError" }
        "404": { $ref: "#/components/responses/NotFound" }
        "401": { $ref: "#/components/responses/Unauthorised" }
        "200": { $ref: "#/components/responses/PostReactAddOK" }

components:
  #
  # 8888888b.     d8888 8888888b.         d8888 888b     d888 8888888888 88888888888 8888888888 8888888b.   .d8888b.
  # 888   Y88b   d88888 888   Y88b       d88888 8888b   d8888 888            888     888        888   Y88b d88P  Y88b
  # 888    888  d88P888 888    888      d88P888 88888b.d88888 888            888     888        888    888 Y88b.
  # 888   d88P d88P 888 888   d88P     d88P 888 888Y88888P888 8888888        888     8888888    888   d88P  "Y888b.
  # 8888888P" d88P  888 8888888P"     d88P  888 888 Y888P 888 888            888     888        8888888P"      "Y88b.
  # 888      d88P   888 888 T88b     d88P   888 888  Y8P  888 888            888     888        888 T88b         "888
  # 888     d8888888888 888  T88b   d8888888888 888   "   888 888            888     888        888  T88b  Y88b  d88P
  # 888    d88P     888 888   T88b d88P     888 888       888 8888888888     888     8888888888 888   T88b  "Y8888P"
  #

  parameters:
    AccountHandleParam:
      description: Account handle.
      example: southclaws
      name: account_handle
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/AccountHandle"

    ThreadMarkParam:
      description: Thread unique and permanent identifier.
      name: thread_mark
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/ThreadMark"

    PostIDParam:
      description: Unique post ID.
      name: post_id
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Identifier"

    OAuthProvider:
      description: The identifier for an OAuth2 provider such as "twitter".
      name: oauth_provider
      in: path
      required: true
      example: twitter
      schema:
        type: string

  #
  # 8888888b.  8888888888 .d88888b.  888     888 8888888888 .d8888b. 88888888888 .d8888b.
  # 888   Y88b 888       d88P" "Y88b 888     888 888       d88P  Y88b    888    d88P  Y88b
  # 888    888 888       888     888 888     888 888       Y88b.         888    Y88b.
  # 888   d88P 8888888   888     888 888     888 8888888    "Y888b.      888     "Y888b.
  # 8888888P"  888       888     888 888     888 888           "Y88b.    888        "Y88b.
  # 888 T88b   888       888 Y8b 888 888     888 888             "888    888          "888
  # 888  T88b  888       Y88b.Y8b88P Y88b. .d88P 888       Y88b  d88P    888    Y88b  d88P
  # 888   T88b 8888888888 "Y888888"   "Y88888P"  8888888888 "Y8888P"     888     "Y8888P"
  #                             Y8b
  #

  requestBodies:
    AuthPassword:
      content:
        application/json:
          schema: { $ref: "#/components/schemas/AuthPair" }

    OAuthProviderCallback:
      content:
        application/json:
          schema: { $ref: "#/components/schemas/OAuthCallback" }

    WebAuthnMakeCredential:
      content:
        application/json:
          schema: { $ref: "#/components/schemas/PublicKeyCredential" }

    WebAuthnMakeAssertion:
      content:
        application/json:
          schema: { $ref: "#/components/schemas/PublicKeyCredential" }

    PhoneRequestCode:
      content:
        application/json:
          schema: { $ref: "#/components/schemas/PhoneRequestCodeProps" }

    PhoneSubmitCode:
      content:
        application/json:
          schema: { $ref: "#/components/schemas/PhoneSubmitCodeProps" }

    AccountUpdate:
      content:
        application/json:
          schema: { $ref: "#/components/schemas/AccountMutableProps" }

    AccountSetAvatar:
      content:
        application/octet-stream:
          schema:
            type: string
            format: binary

    ThreadCreate:
      content:
        application/json:
          schema: { $ref: "#/components/schemas/ThreadInitialProps" }

    ThreadUpdate:
      content:
        application/json:
          schema: { $ref: "#/components/schemas/ThreadMutableProps" }

    PostCreate:
      description: Create a post within a thread.
      content:
        application/json:
          schema: { $ref: "#/components/schemas/PostInitialProps" }

    PostUpdate:
      description: Create a post within a thread.
      content:
        application/json:
          schema: { $ref: "#/components/schemas/PostMutableProps" }

    PostReactAdd:
      description: Add a reaction to a post.
      content:
        application/json:
          schema: { $ref: "#/components/schemas/PostReactProps" }

  #
  # 8888888b.  8888888888 .d8888b.  8888888b.   .d88888b.  888b    888  .d8888b.  8888888888 .d8888b.
  # 888   Y88b 888       d88P  Y88b 888   Y88b d88P" "Y88b 8888b   888 d88P  Y88b 888       d88P  Y88b
  # 888    888 888       Y88b.      888    888 888     888 88888b  888 Y88b.      888       Y88b.
  # 888   d88P 8888888    "Y888b.   888   d88P 888     888 888Y88b 888  "Y888b.   8888888    "Y888b.
  # 8888888P"  888           "Y88b. 8888888P"  888     888 888 Y88b888     "Y88b. 888           "Y88b.
  # 888 T88b   888             "888 888        888     888 888  Y88888       "888 888             "888
  # 888  T88b  888       Y88b  d88P 888        Y88b. .d88P 888   Y8888 Y88b  d88P 888       Y88b  d88P
  # 888   T88b 8888888888 "Y8888P"  888         "Y88888P"  888    Y888  "Y8888P"  8888888888 "Y8888P"
  #

  responses:
    BadRequest:
      description: Bad request
    NotFound:
      description: Not found
    Unauthorised:
      description: Unauthorized
    InternalServerError:
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/APIError"

    GetInfoOK:
      description: OK
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Info"

    AuthSuccessOK:
      description: OK
      headers:
        "Set-Cookie":
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/AuthSuccess"

    AuthProviderListOK:
      description: OK
      content:
        application/json:
          schema:
            type: object
            required: [providers]
            properties:
              providers: { $ref: "#/components/schemas/AuthProviderList" }

    WebAuthnRequestCredentialOK:
      description: OK
      headers:
        "Set-Cookie":
          schema:
            type: string
      content:
        application/json:
          schema:
            { $ref: "#/components/schemas/WebAuthnPublicKeyCreationOptions" }

    WebAuthnGetAssertionOK:
      description: OK
      headers:
        "Set-Cookie":
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CredentialRequestOptions"

    AccountGetOK:
      description: OK
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Account"

    AccountUpdateOK:
      description: OK
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Account"

    AccountGetAvatar:
      description: OK
      content:
        image/png:
          schema:
            type: string
            format: binary

    ProfileGetOK:
      description: OK
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/PublicProfile"

    CategoryListOK:
      description: OK
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CategoryList"

    ThreadCreateOK:
      description: Thread created.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Thread"

    ThreadUpdateOK:
      description: Thread updated.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Thread"

    ThreadListOK:
      description: List of all threads.
      content:
        application/json:
          schema:
            type: object
            required: [threads]
            properties:
              threads: { $ref: "#/components/schemas/ThreadList" }

    ThreadGet:
      description: The information about a thread and its posts.
      content:
        application/json:
          schema: { $ref: "#/components/schemas/Thread" }

    PostCreateOK:
      description: Thread post created successfully.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/PostProps"

    PostUpdateOK:
      description: Thread post updated successfully.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/PostProps"

    PostSearchOK:
      description: Thread post updated successfully.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/PostSearchResults"

    PostReactAddOK:
      description: Post reaction added.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/React"

  #
  #  .d8888b.   .d8888b.  888    888 8888888888 888b     d888        d8888  .d8888b.
  # d88P  Y88b d88P  Y88b 888    888 888        8888b   d8888       d88888 d88P  Y88b
  # Y88b.      888    888 888    888 888        88888b.d88888      d88P888 Y88b.
  #  "Y888b.   888        8888888888 8888888    888Y88888P888     d88P 888  "Y888b.
  #     "Y88b. 888        888    888 888        888 Y888P 888    d88P  888     "Y88b.
  #       "888 888    888 888    888 888        888  Y8P  888   d88P   888       "888
  # Y88b  d88P Y88b  d88P 888    888 888        888   "   888  d8888888888 Y88b  d88P
  #  "Y8888P"   "Y8888P"  888    888 8888888888 888       888 d88P     888  "Y8888P"
  #

  schemas:
    #
    #  .d8888b.
    # d88P  Y88b
    # 888    888
    # 888         .d88b.  88888b.d88b.  88888b.d88b.   .d88b.  88888b.
    # 888        d88""88b 888 "888 "88b 888 "888 "88b d88""88b 888 "88b
    # 888    888 888  888 888  888  888 888  888  888 888  888 888  888
    # Y88b  d88P Y88..88P 888  888  888 888  888  888 Y88..88P 888  888
    #  "Y8888P"   "Y88P"  888  888  888 888  888  888  "Y88P"  888  888
    #

    Identifier:
      type: string
      format: xid
      # NOTE: Does not work currently with oapi-codegen because it generates a
      # new type declaration instead of a type alias so the unmarshalling fails.
      # To work around this, there are special conversion APIs in the oapi pkg.
      x-go-type: string
      # x-go-type-import:
      #   name: xid
      #   path: github.com/rs/xid
      example: "cc5lnd2s1s4652adtu50"
      description: A unique identifier for this resource.

    Info:
      description: Basic public information about the Storyden installation.
      type: object
      required: [title, description]
      properties:
        title:
          type: string
        description:
          type: string

    ContentKind:
      type: string
      enum: [post, thread]

    ContentKinds:
      type: array
      items: { $ref: "#/components/schemas/ContentKind" }

    ThreadMark:
      description: |
        A thread's ID and optional slug separated by a dash = it's unique mark.
        This allows endpoints to respond to varying forms of a thread's ID.

        For example, given a thread with the ID `cc5lnd2s1s4652adtu50` and the
        slug `top-10-movies-thread`, Storyden will understand both the forms:
        `cc5lnd2s1s4652adtu50-top-10-movies-thread` and `cc5lnd2s1s4652adtu50`
         as the identifier for that thread.
      x-go-type: string
      type: string
      format: xid-prefixed-kebab-case-string
      example: "cc5lnd2s1s4652adtu50-top-10-movies-thread"

    CommonProperties:
      type: object
      required:
        - id
        - createdAt
        - updatedAt
      properties:
        id: { $ref: "#/components/schemas/Identifier" }
        createdAt:
          type: string
          format: date-time
          description: The time the resource was created.
        updatedAt:
          type: string
          format: date-time
          description: The time the resource was updated.
        deletedAt:
          type: string
          format: date-time
          description: The time the resource was soft-deleted.
        misc:
          type: object
          description: Arbitrary extra data stored with the resource.

    APIError:
      type: object
      description: |
        A description of an error including a human readable message and any
        related metadata from the request and associated services.
      required: [error]
      properties:
        error:
          description: The internal error, not intended for end-user display.
          type: string
        message:
          description: A human-readable message intended for end-user display.
          type: string
        suggested:
          description: A suggested action for the user.
          type: string
        metadata:
          description: Any additional metadata related to the error.
          type: object
          additionalProperties: true

    Metadata:
      type: object
      additionalProperties: true
      description: Arbitrary metadata for the resource.

    AccountName:
      type: string
      description: The account owners display name.
      example: Barnaby Keene

    AccountHandle:
      type: string
      x-go-type: string
      description: The unique @ handle of an account.
      example: Southclaws

    ProfileReference:
      type: object
      description: A minimal reference to an account.
      required: [id, handle, name]
      properties:
        id: { $ref: "#/components/schemas/Identifier" }
        handle: { $ref: "#/components/schemas/AccountHandle" }
        name: { $ref: "#/components/schemas/AccountName" }

    ThreadTitle:
      type: string
      description: The title of a thread.
      example: Hello world!

    Tag:
      type: object
      description: A tag which can link profiles or threads via interests.
      required: [id, name]
      properties:
        id: { $ref: "#/components/schemas/Identifier" }
        name: { $ref: "#/components/schemas/TagName" }
        colour: { type: string }

    TagName:
      type: string
      description: The name of a tag.

    TagList:
      type: array
      description: A list of tags.
      items: { $ref: "#/components/schemas/Tag" }

    TagListIDs:
      type: array
      description: A list of tags IDs.
      items: { $ref: "#/components/schemas/Identifier" }

    PostBodyMarkdown:
      type: string
      description: The body text of a post within a thread.
      example: |
        # My post

        This is a _post_ within a _thread_ formatted in *markdown*.

    #
    #        d8888          888    888
    #       d88888          888    888
    #      d88P888          888    888
    #     d88P 888 888  888 888888 88888b.
    #    d88P  888 888  888 888    888 "88b
    #   d88P   888 888  888 888    888  888
    #  d8888888888 Y88b 888 Y88b.  888  888
    # d88P     888  "Y88888  "Y888 888  888
    #

    AuthProviderList:
      type: array
      items:
        $ref: "#/components/schemas/AuthProvider"

    AuthProvider:
      type: object
      required: [provider, name, logo_url, link]
      properties:
        provider:
          description: The slug name of the provider.
          type: string
        name:
          description: The human-readable name of the provider.
          type: string
        logo_url:
          description: The logo to display for the provider.
          type: string
        link:
          description: The hyperlink to render for the user.
          type: string

    AuthPair:
      type: object
      required: [identifier, token]
      properties:
        identifier:
          example: "southclaws@storyden.org"
          type: string
        token:
          example: "password"
          type: string

    AuthSuccess:
      type: object
      required: [id]
      properties:
        id:
          type: string

    OAuthCallback:
      type: object
      required:
        - state
        - code
      properties:
        state:
          type: string
        code:
          type: string

    WebAuthnPublicKeyCreationOptions:
      description: |
        https://www.w3.org/TR/webauthn-2/#sctn-credentialcreationoptions-extension
      type: object
      required: [publicKey]
      properties:
        publicKey:
          $ref: "#/components/schemas/PublicKeyCredentialCreationOptions"

    PublicKeyCredentialCreationOptions:
      description: |
        https://www.w3.org/TR/webautehn-2/#dictdef-publickeycredentialcreationoptions
      type: object
      required:
        - rp
        - user
        - challenge
        - excludeCredentials
        - pubKeyCredParams
      properties:
        rp: { $ref: "#/components/schemas/PublicKeyCredentialRpEntity" }
        user: { $ref: "#/components/schemas/PublicKeyCredentialUserEntity" }

        challenge:
          type: string
        pubKeyCredParams:
          type: array
          items: { $ref: "#/components/schemas/PublicKeyCredentialParameters" }

        timeout:
          type: integer
        excludeCredentials:
          type: array
          items: { $ref: "#/components/schemas/PublicKeyCredentialDescriptor" }
        authenticatorSelection:
          { $ref: "#/components/schemas/AuthenticatorSelectionCriteria" }
        attestation:
          { $ref: "#/components/schemas/AttestationConveyancePreference" }
        extensions:
          { $ref: "#/components/schemas/AuthenticationExtensionsClientInputs" }

    PublicKeyCredentialRpEntity:
      description: |
        https://www.w3.org/TR/webauthn-2/#dictdef-publickeycredentialrpentity
      type: object
      required: [name, id]
      properties:
        id:
          type: string
        name:
          type: string

    PublicKeyCredentialUserEntity:
      description: |
        https://www.w3.org/TR/webauthn-2/#dictdef-publickeycredentialuserentity
      type: object
      required: [id, name, displayName]
      properties:
        id:
          type: string
        name:
          type: string
        displayName:
          type: string

    PublicKeyCredentialParameters:
      description: |
        https://www.w3.org/TR/webauthn-2/#dictdef-publickeycredentialparameters
      type: object
      required: [type, alg]
      properties:
        type:
          $ref: "#/components/schemas/PublicKeyCredentialType"
        alg:
          type: number

    PublicKeyCredentialType:
      description: |
        https://www.w3.org/TR/webauthn-2/#enumdef-publickeycredentialtype
      type: string
      enum: [public-key]

    PublicKeyCredentialDescriptor:
      description: |
        https://www.w3.org/TR/webauthn-2/#dictdef-publickeycredentialdescriptor
      type: object
      required: [type, id]
      properties:
        type:
          $ref: "#/components/schemas/PublicKeyCredentialType"
        id:
          type: string
        transports:
          type: array
          items:
            type: string
            enum: ["ble", "internal", "nfc", "usb", "cable", "hybrid"]

    AuthenticatorSelectionCriteria:
      description: |
        https://www.w3.org/TR/webauthn-2/#dictdef-authenticatorselectioncriteria
      type: object
      required:
        - authenticatorAttachment
        - residentKey
      properties:
        authenticatorAttachment:
          $ref: "#/components/schemas/AuthenticatorAttachment"
        residentKey:
          $ref: "#/components/schemas/ResidentKeyRequirement"
        requireResidentKey:
          type: boolean
        userVerification:
          $ref: "#/components/schemas/UserVerificationRequirement"

    AuthenticatorAttachment:
      description: |
        https://www.w3.org/TR/webauthn-2/#enumdef-authenticatorattachment
      type: string
      enum: [platform, cross-platform]

    ResidentKeyRequirement:
      description: |
        https://www.w3.org/TR/webauthn-2/#enumdef-residentkeyrequirement
      type: string
      enum:
        - discouraged
        - preferred
        - required

    UserVerificationRequirement:
      description: |
        https://www.w3.org/TR/webauthn-2/#enumdef-userverificationrequirement
      type: string
      default: preferred
      enum:
        - discouraged
        - preferred
        - required

    AttestationConveyancePreference:
      description: |
        https://www.w3.org/TR/webauthn-2/#enum-attestation-convey
      type: string
      enum:
        - direct
        - enterprise
        - indirect
        - none

    AuthenticationExtensionsClientInputs:
      description: |
        https://www.w3.org/TR/webauthn-2/#dictdef-authenticationextensionsclientinputs
      type: object
      additionalProperties: true

    PublicKeyCredential:
      description: |
        https://www.w3.org/TR/webauthn-2/#iface-pkcredential
      type: object
      required:
        - id
        - rawId
        - response
        - type
      properties:
        id:
          type: string
        rawId:
          type: string
        response: { $ref: "#/components/schemas/AuthenticatorResponse" }
        type:
          type: string
        clientExtensionResults:
          type: object
        authenticatorAttachment:
          type: string

    AuthenticatorResponse:
      description: |
        https://www.w3.org/TR/webauthn-2/#authenticatorresponse
      type: object
      required: [clientDataJSON]
      properties:
        clientDataJSON:
          type: string
        attestationObject:
          type: string
        transports:
          type: array
          items:
            type: string
        authenticatorData:
          type: string
        signature:
          type: string
        userHandle:
          type: string

    CredentialRequestOptions:
      description: |
        https://www.w3.org/TR/webauthn-2/#sctn-credentialrequestoptions-extension
      type: object
      required: [publicKey]
      properties:
        publicKey:
          $ref: "#/components/schemas/PublicKeyCredentialRequestOptions"

    PublicKeyCredentialRequestOptions:
      description: |
        https://www.w3.org/TR/webauthn-2/#dictdef-publickeycredentialrequestoptions
      type: object
      required: [challenge]
      properties:
        challenge:
          type: string
        timeout:
          type: integer
        rpId:
          type: string
        allowCredentials:
          type: array
          items:
            $ref: "#/components/schemas/PublicKeyCredentialDescriptor"
        userVerification:
          type: string
          enum: ["discouraged", "preferred", "required"]

    PhoneRequestCodeProps:
      description: The phone number request payload.
      type: object
      required: [identifier, phone_number]
      properties:
        identifier:
          description: The desired username to link to the phone number.
          example: "southclaws"
          type: string
        phone_number:
          description: The phone number to receive the one-time code on.
          type: string

    PhoneSubmitCodeProps:
      description: The Phone submit code payload.
      type: object
      required: [code]
      properties:
        code:
          type: string

    #
    #        d8888                                            888
    #       d88888                                            888
    #      d88P888                                            888
    #     d88P 888  .d8888b .d8888b .d88b.  888  888 88888b.  888888
    #    d88P  888 d88P"   d88P"   d88""88b 888  888 888 "88b 888
    #   d88P   888 888     888     888  888 888  888 888  888 888
    #  d8888888888 Y88b.   Y88b.   Y88..88P Y88b 888 888  888 Y88b.
    # d88P     888  "Y8888P "Y8888P "Y88P"   "Y88888 888  888  "Y888
    #

    Account:
      type: object
      allOf:
        - $ref: "#/components/schemas/CommonProperties"
        - required: [handle, id]
          properties:
            handle:
              $ref: "#/components/schemas/AccountHandle"
            name:
              $ref: "#/components/schemas/AccountName"
            bio:
              type: string
            interests:
              $ref: "#/components/schemas/TagList"

    AccountMutableProps:
      type: object
      properties:
        handle:
          $ref: "#/components/schemas/AccountHandle"
        name:
          $ref: "#/components/schemas/AccountName"
        bio:
          type: string
        interests:
          $ref: "#/components/schemas/TagListIDs"

    #
    # 8888888b.                   .d888 d8b 888
    # 888   Y88b                 d88P"  Y8P 888
    # 888    888                 888        888
    # 888   d88P 888d888 .d88b.  888888 888 888  .d88b.
    # 8888888P"  888P"  d88""88b 888    888 888 d8P  Y8b
    # 888        888    888  888 888    888 888 88888888
    # 888        888    Y88..88P 888    888 888 Y8b.
    # 888        888     "Y88P"  888    888 888  "Y8888
    #

    PublicProfile:
      type: object
      allOf:
        - $ref: "#/components/schemas/CommonProperties"
        - required: [id, handle, name, createdAt, interests]
          properties:
            handle:
              $ref: "#/components/schemas/AccountHandle"
            name:
              $ref: "#/components/schemas/AccountName"
            bio:
              type: string
            image:
              type: string
            createdAt:
              type: string
            interests:
              $ref: "#/components/schemas/TagList"

    #
    #  .d8888b.           888
    # d88P  Y88b          888
    # 888    888          888
    # 888         8888b.  888888 .d88b.   .d88b.   .d88b.  888d888 888  888
    # 888            "88b 888   d8P  Y8b d88P"88b d88""88b 888P"   888  888
    # 888    888 .d888888 888   88888888 888  888 888  888 888     888  888
    # Y88b  d88P 888  888 Y88b. Y8b.     Y88b 888 Y88..88P 888     Y88b 888
    #  "Y8888P"  "Y888888  "Y888 "Y8888   "Y88888  "Y88P"  888      "Y88888
    #                                         888                       888
    #                                    Y8b d88P                  Y8b d88P
    #                                     "Y88P"                    "Y88P"
    #

    Category:
      type: object
      allOf:
        - $ref: "#/components/schemas/CategoryMetadata"
        - $ref: "#/components/schemas/CategoryCommon"
        - $ref: "#/components/schemas/CategoryAdditional"

    CategoryReference:
      type: object
      allOf:
        - $ref: "#/components/schemas/CategoryMetadata"
        - $ref: "#/components/schemas/CategoryCommon"

    CategoryMetadata:
      type: object
      properties:
        id: { $ref: "#/components/schemas/Identifier" }

    CategoryCommon:
      type: object
      required: [name, sort]
      properties:
        name:
          $ref: "#/components/schemas/CategoryName"
        description:
          type: string
        colour:
          type: string
        sort:
          type: integer
        admin:
          type: boolean

    CategoryName:
      description: A category's user-facing name.
      type: string

    CategoryNameList:
      description: A list of category names.
      type: array
      items:
        $ref: "#/components/schemas/CategoryName"

    CategoryAdditional:
      type: object
      required: [postCount]
      properties:
        postCount:
          type: integer

    CategoryList:
      type: object
      required: [categories]
      properties:
        categories:
          type: array
          items: { $ref: "#/components/schemas/Category" }

    #
    # 88888888888 888                                    888
    #     888     888                                    888
    #     888     888                                    888
    #     888     88888b.  888d888 .d88b.   8888b.   .d88888
    #     888     888 "88b 888P"  d8P  Y8b     "88b d88" 888
    #     888     888  888 888    88888888 .d888888 888  888
    #     888     888  888 888    Y8b.     888  888 Y88b 888
    #     888     888  888 888     "Y8888  "Y888888  "Y88888
    #

    ThreadInitialProps:
      type: object
      required:
        - title
        - body
        - category
      properties:
        title: { $ref: "#/components/schemas/ThreadTitle" }
        body: { $ref: "#/components/schemas/PostBodyMarkdown" }
        tags: { $ref: "#/components/schemas/TagListIDs" }
        meta: { $ref: "#/components/schemas/Metadata" }
        category: { $ref: "#/components/schemas/Identifier" }

    ThreadMutableProps:
      type: object
      properties:
        title: { $ref: "#/components/schemas/ThreadTitle" }
        body: { $ref: "#/components/schemas/PostBodyMarkdown" }
        tags: { $ref: "#/components/schemas/TagListIDs" }
        meta: { $ref: "#/components/schemas/Metadata" }
        category: { $ref: "#/components/schemas/Identifier" }

    ThreadReference:
      description: |
        A thread reference includes most of the information about a thread but
        does not include the posts within the thread. Useful for rendering large
        lists of threads or other situations when you don't need the full data.
      allOf:
        - $ref: "#/components/schemas/CommonProperties"
        - type: object
          required:
            - title
            - slug
            - short
            - pinned
            - author
            - tags
            - post_count
            - category
            - reacts
            - meta
          properties:
            title:
              type: string
              example: Hello world!
              description: The title of the thread.
            slug: { $ref: "#/components/schemas/ThreadMark" }
            short:
              type: string
              readOnly: true
              description: |
                A short version of the thread's body text for use in previews.
            pinned:
              type: boolean
              description: Whether the thread is pinned in this category.
            author: { $ref: "#/components/schemas/ProfileReference" }
            tags:
              type: array
              items:
                type: string
              description: A list of tags associated with the thread.
            post_count:
              type: integer
              readOnly: true
              description: The number of posts under this thread.
            category: { $ref: "#/components/schemas/CategoryReference" }
            reacts:
              $ref: "#/components/schemas/ReactList"
            meta: { $ref: "#/components/schemas/Metadata" }

    ThreadList:
      type: array
      items:
        $ref: "#/components/schemas/ThreadReference"

    Thread:
      allOf:
        - $ref: "#/components/schemas/ThreadReference"
        - type: object
          required:
            [title, slug, short, pinned, author, tags, posts, category, reacts]
          properties:
            posts:
              type: array
              items: { $ref: "#/components/schemas/PostProps" }

    #
    # 8888888b.                   888
    # 888   Y88b                  888
    # 888    888                  888
    # 888   d88P .d88b.  .d8888b  888888
    # 8888888P" d88""88b 88K      888
    # 888       888  888 "Y8888b. 888
    # 888       Y88..88P      X88 Y88b.
    # 888        "Y88P"   88888P'  "Y888
    #

    PostProps:
      type: object
      description: |
        A new post within a thread of posts. A post may reply to another post in
        the thread by specifying the `reply_to` property. The identifier in the
        `reply_to` value must be post within the same thread.
      allOf:
        - { $ref: "#/components/schemas/PostMetadata" }
        - { $ref: "#/components/schemas/PostCommonProps" }

    PostMetadata:
      type: object
      allOf:
        - { $ref: "#/components/schemas/CommonProperties" }

    PostCommonProps:
      type: object
      required: [root_id, root_slug, body, author, reacts]
      properties:
        root_id: { $ref: "#/components/schemas/Identifier" }
        root_slug: { $ref: "#/components/schemas/ThreadMark" }
        body: { $ref: "#/components/schemas/PostBodyMarkdown" }
        author: { $ref: "#/components/schemas/ProfileReference" }
        meta: { $ref: "#/components/schemas/Metadata" }
        reacts: { $ref: "#/components/schemas/ReactList" }
        reply_to: { $ref: "#/components/schemas/Identifier" }

    PostInitialProps:
      type: object
      required: [body]
      properties:
        body: { $ref: "#/components/schemas/PostBodyMarkdown" }
        meta: { $ref: "#/components/schemas/Metadata" }
        reply_to: { $ref: "#/components/schemas/Identifier" }

    PostMutableProps:
      type: object
      properties:
        body: { $ref: "#/components/schemas/PostBodyMarkdown" }
        meta: { $ref: "#/components/schemas/Metadata" }

    ReactList:
      description: A list of reactions this post has had from people.
      type: array
      items: { $ref: "#/components/schemas/React" }

    React:
      type: object
      properties:
        id: { $ref: "#/components/schemas/Identifier" }
        emoji:
          type: string

    PostReactProps:
      description: |
        Reactions are currently just simple strings but they may improve later.
      type: object
      properties:
        emoji:
          type: string

    PostSearchResults:
      type: object
      required: [count, results]
      properties:
        count:
          type: number
        results:
          type: array
          items:
            $ref: "#/components/schemas/PostProps"

  securitySchemes:
    browser:
      type: apiKey
      in: cookie
      name: storyden-session
    webauthn:
      type: apiKey
      in: cookie
      name: "storyden-webauthn-session"
#
#     ..:.                                                        .***=
#  .+#%%%%%#+   ...                                               :%%%+
#  #%%%+==+#.  =%%%.                                              :%%%+
# :%%%%:      -*%%%=-.   :==+==:    ---: :== ----     .---- .-===-:%%%+   :==+=-:   .---..-==-.
#  +%%%%%#*=. #%%%%%%-.+%%%%#%%%%+ .%%%##%%% -%%%#.  .#%%#=*%%%%%%%%%%+ =%%#+=+#%#- -%%%#%#%%%%*
#   .-+#%%%%%- +%%%:..#%%%=   +%%%*.%%%#-. .  :#%%#..#%%#:#%%%=  .+%%%+-%%%*===+%%%:-%%%+  .#%%%.
#        +%%%# =%%%. .%%%#    .%%%%.%%%+       .#%%##%%#:.%%%#    :%%%+=%%%*+++++++:-%%%:   +%%%.
# .##*===#%%%= =%%%.  +%%%#=-=#%%%-.%%%+        .#%%%%*.  +%%%#=-=#%%%+.#%%+:..=++= -%%%:   +%%%.
# -*%%%%%%%*-  =%%%.   :*%%%%%%#+: .%%%+         -%%%#.    -*%%%%%*%%%+ .+#%%%%%%+. -%%%:   +%%%.
#    .:::.                .:::.                 -%%%*.        .:.          .:::.
#                                              -%%%*
#                                             -***+
#
