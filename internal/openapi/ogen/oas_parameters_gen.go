// Code generated by ogen, DO NOT EDIT.

package ogen

import (
	"net/http"

	"github.com/go-faster/errors"

	"github.com/ogen-go/ogen/conv"
	"github.com/ogen-go/ogen/uri"
)

// AccountsGetAvatarParams is parameters of AccountsGetAvatar operation.
type AccountsGetAvatarParams struct {
	// Account handle.
	AccountHandle string
}

func unpackAccountsGetAvatarParams(packed map[string]any) (params AccountsGetAvatarParams) {
	params.AccountHandle = packed["account_handle"].(string)
	return params
}

func decodeAccountsGetAvatarParams(args [1]string, r *http.Request) (params AccountsGetAvatarParams, _ error) {
	// Decode path: account_handle.
	{
		param := args[0]
		if len(param) > 0 {
			d := uri.NewPathDecoder(uri.PathDecoderConfig{
				Param:   "account_handle",
				Value:   param,
				Style:   uri.PathStyleSimple,
				Explode: false,
			})

			if err := func() error {
				val, err := d.DecodeValue()
				if err != nil {
					return err
				}

				c, err := conv.ToString(val)
				if err != nil {
					return err
				}

				params.AccountHandle = c
				return nil
			}(); err != nil {
				return params, errors.Wrap(err, "path: account_handle: parse")
			}
		} else {
			return params, errors.New("path: account_handle: not specified")
		}
	}
	return params, nil
}

// AuthOAuthProviderCallbackParams is parameters of AuthOAuthProviderCallback operation.
type AuthOAuthProviderCallbackParams struct {
	// The identifier for an OAuth2 provider such as "twitter".
	OAuthProvider string
}

func unpackAuthOAuthProviderCallbackParams(packed map[string]any) (params AuthOAuthProviderCallbackParams) {
	params.OAuthProvider = packed["oauth_provider"].(string)
	return params
}

func decodeAuthOAuthProviderCallbackParams(args [1]string, r *http.Request) (params AuthOAuthProviderCallbackParams, _ error) {
	// Decode path: oauth_provider.
	{
		param := args[0]
		if len(param) > 0 {
			d := uri.NewPathDecoder(uri.PathDecoderConfig{
				Param:   "oauth_provider",
				Value:   param,
				Style:   uri.PathStyleSimple,
				Explode: false,
			})

			if err := func() error {
				val, err := d.DecodeValue()
				if err != nil {
					return err
				}

				c, err := conv.ToString(val)
				if err != nil {
					return err
				}

				params.OAuthProvider = c
				return nil
			}(); err != nil {
				return params, errors.Wrap(err, "path: oauth_provider: parse")
			}
		} else {
			return params, errors.New("path: oauth_provider: not specified")
		}
	}
	return params, nil
}

// PostsCreateParams is parameters of PostsCreate operation.
type PostsCreateParams struct {
	// Thread ID.
	ThreadID Identifier
}

func unpackPostsCreateParams(packed map[string]any) (params PostsCreateParams) {
	params.ThreadID = packed["thread_id"].(Identifier)
	return params
}

func decodePostsCreateParams(args [1]string, r *http.Request) (params PostsCreateParams, _ error) {
	// Decode path: thread_id.
	{
		param := args[0]
		if len(param) > 0 {
			d := uri.NewPathDecoder(uri.PathDecoderConfig{
				Param:   "thread_id",
				Value:   param,
				Style:   uri.PathStyleSimple,
				Explode: false,
			})

			if err := func() error {
				var paramsDotThreadIDVal string
				if err := func() error {
					val, err := d.DecodeValue()
					if err != nil {
						return err
					}

					c, err := conv.ToString(val)
					if err != nil {
						return err
					}

					paramsDotThreadIDVal = c
					return nil
				}(); err != nil {
					return err
				}
				params.ThreadID = Identifier(paramsDotThreadIDVal)
				return nil
			}(); err != nil {
				return params, errors.Wrap(err, "path: thread_id: parse")
			}
		} else {
			return params, errors.New("path: thread_id: not specified")
		}
	}
	return params, nil
}

// ProfilesGetParams is parameters of ProfilesGet operation.
type ProfilesGetParams struct {
	// Account handle.
	AccountHandle string
}

func unpackProfilesGetParams(packed map[string]any) (params ProfilesGetParams) {
	params.AccountHandle = packed["account_handle"].(string)
	return params
}

func decodeProfilesGetParams(args [1]string, r *http.Request) (params ProfilesGetParams, _ error) {
	// Decode path: account_handle.
	{
		param := args[0]
		if len(param) > 0 {
			d := uri.NewPathDecoder(uri.PathDecoderConfig{
				Param:   "account_handle",
				Value:   param,
				Style:   uri.PathStyleSimple,
				Explode: false,
			})

			if err := func() error {
				val, err := d.DecodeValue()
				if err != nil {
					return err
				}

				c, err := conv.ToString(val)
				if err != nil {
					return err
				}

				params.AccountHandle = c
				return nil
			}(); err != nil {
				return params, errors.Wrap(err, "path: account_handle: parse")
			}
		} else {
			return params, errors.New("path: account_handle: not specified")
		}
	}
	return params, nil
}

// ThreadsListParams is parameters of ThreadsList operation.
type ThreadsListParams struct {
	// Show only results creeated by this user.
	Author OptAccountHandle
	// Show only results with these tags.
	Tags *TagListIDs
}

func unpackThreadsListParams(packed map[string]any) (params ThreadsListParams) {
	if v, ok := packed["author"]; ok {
		params.Author = v.(OptAccountHandle)
	}
	if v, ok := packed["tags"]; ok {
		params.Tags = v.(*TagListIDs)
	}
	return params
}

func decodeThreadsListParams(args [0]string, r *http.Request) (params ThreadsListParams, _ error) {
	q := uri.NewQueryDecoder(r.URL.Query())
	// Decode query: author.
	{
		cfg := uri.QueryParameterDecodingConfig{
			Name:    "author",
			Style:   uri.QueryStyleForm,
			Explode: true,
		}

		if err := q.HasParam(cfg); err == nil {
			if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
				var paramsDotAuthorVal AccountHandle
				if err := func() error {
					var paramsDotAuthorValVal string
					if err := func() error {
						val, err := d.DecodeValue()
						if err != nil {
							return err
						}

						c, err := conv.ToString(val)
						if err != nil {
							return err
						}

						paramsDotAuthorValVal = c
						return nil
					}(); err != nil {
						return err
					}
					paramsDotAuthorVal = AccountHandle(paramsDotAuthorValVal)
					return nil
				}(); err != nil {
					return err
				}
				params.Author.SetTo(paramsDotAuthorVal)
				return nil
			}); err != nil {
				return params, errors.Wrap(err, "query: author: parse")
			}
		}
	}
	// Decode query: tags.
	{
		cfg := uri.QueryParameterDecodingConfig{
			Name:    "tags",
			Style:   uri.QueryStyleForm,
			Explode: true,
		}

		if err := q.HasParam(cfg); err == nil {
			if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
				var paramsDotTagsVal TagListIDs
				if err := func() error {
					var paramsDotTagsValVal []Identifier
					if err := func() error {
						return d.DecodeArray(func(d uri.Decoder) error {
							var paramsDotTagsValValVal Identifier
							if err := func() error {
								var paramsDotTagsValValValVal string
								if err := func() error {
									val, err := d.DecodeValue()
									if err != nil {
										return err
									}

									c, err := conv.ToString(val)
									if err != nil {
										return err
									}

									paramsDotTagsValValValVal = c
									return nil
								}(); err != nil {
									return err
								}
								paramsDotTagsValValVal = Identifier(paramsDotTagsValValValVal)
								return nil
							}(); err != nil {
								return err
							}
							paramsDotTagsValVal = append(paramsDotTagsValVal, paramsDotTagsValValVal)
							return nil
						})
					}(); err != nil {
						return err
					}
					paramsDotTagsVal = TagListIDs(paramsDotTagsValVal)
					return nil
				}(); err != nil {
					return err
				}
				params.Tags = &paramsDotTagsVal
				return nil
			}); err != nil {
				return params, errors.Wrap(err, "query: tags: parse")
			}
			if err := func() error {
				if params.Tags == nil {
					return nil // optional
				}
				if err := func() error {
					if err := params.Tags.Validate(); err != nil {
						return err
					}
					return nil
				}(); err != nil {
					return errors.Wrap(err, "pointer")
				}
				return nil
			}(); err != nil {
				return params, errors.Wrap(err, "query: tags: invalid")
			}
		}
	}
	return params, nil
}

// WebAuthnGetAssertionParams is parameters of WebAuthnGetAssertion operation.
type WebAuthnGetAssertionParams struct {
	// Account handle.
	AccountHandle string
}

func unpackWebAuthnGetAssertionParams(packed map[string]any) (params WebAuthnGetAssertionParams) {
	params.AccountHandle = packed["account_handle"].(string)
	return params
}

func decodeWebAuthnGetAssertionParams(args [1]string, r *http.Request) (params WebAuthnGetAssertionParams, _ error) {
	// Decode path: account_handle.
	{
		param := args[0]
		if len(param) > 0 {
			d := uri.NewPathDecoder(uri.PathDecoderConfig{
				Param:   "account_handle",
				Value:   param,
				Style:   uri.PathStyleSimple,
				Explode: false,
			})

			if err := func() error {
				val, err := d.DecodeValue()
				if err != nil {
					return err
				}

				c, err := conv.ToString(val)
				if err != nil {
					return err
				}

				params.AccountHandle = c
				return nil
			}(); err != nil {
				return params, errors.Wrap(err, "path: account_handle: parse")
			}
		} else {
			return params, errors.New("path: account_handle: not specified")
		}
	}
	return params, nil
}

// WebAuthnRequestCredentialParams is parameters of WebAuthnRequestCredential operation.
type WebAuthnRequestCredentialParams struct {
	// Account handle.
	AccountHandle string
}

func unpackWebAuthnRequestCredentialParams(packed map[string]any) (params WebAuthnRequestCredentialParams) {
	params.AccountHandle = packed["account_handle"].(string)
	return params
}

func decodeWebAuthnRequestCredentialParams(args [1]string, r *http.Request) (params WebAuthnRequestCredentialParams, _ error) {
	// Decode path: account_handle.
	{
		param := args[0]
		if len(param) > 0 {
			d := uri.NewPathDecoder(uri.PathDecoderConfig{
				Param:   "account_handle",
				Value:   param,
				Style:   uri.PathStyleSimple,
				Explode: false,
			})

			if err := func() error {
				val, err := d.DecodeValue()
				if err != nil {
					return err
				}

				c, err := conv.ToString(val)
				if err != nil {
					return err
				}

				params.AccountHandle = c
				return nil
			}(); err != nil {
				return params, errors.Wrap(err, "path: account_handle: parse")
			}
		} else {
			return params, errors.New("path: account_handle: not specified")
		}
	}
	return params, nil
}
