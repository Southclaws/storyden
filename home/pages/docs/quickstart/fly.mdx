---
title: Fly.io
description: Setting up a Storyden instance on Fly.io in under 5 minutes!
---

# Fly.io

Fly.io is a platform for running Docker containers on a global network of edge servers. It's a great fit for Storyden because it's container-native and super simple to get started!

Once you've created an account on Fly.io and set up the CLI, you can launch a Storyden instance with a single command:

```sh
fly launch --image ghcr.io/southclaws/storyden --name storyden --internal-port 3000
```

This will create a new Storyden instance with the name `storyden` and the latest version of Storyden. You can then visit the URL that Fly.io gives you and you'll see the Storyden homepage!

We use the `--internal-port 3000` flag since the default image runs the frontend (the app you see when you visit the URL) on port 3000.

Once you run that, you should see some information about your app as its being deployed:

```css
Using image ghcr.io/southclaws/storyden
Creating app in /Users/southclaws
We're about to launch your app on Fly.io. Here's what you're getting:

Organization: Your Name                 (fly launch defaults to the personal org)
Name:         storyden-unique-name-1234 (specified on the command line)
Region:       London, United Kingdom    (this is the fastest region for you)
App Machines: shared-cpu-1x, 1GB RAM    (most apps need about 1GB of RAM)
Postgres:     <none>                    (not requested)
Redis:        <none>                    (not requested)

~

Provisioning ips for storyden-unique-name-1234
  Dedicated ipv6: 1a2b:1a2b:1::1a:1a2b
  Shared ipv4: 66.241.124.124
  Add a dedicated ipv4 with: fly ips allocate-v4

This deployment will:
 * create 2 "app" machines

No machines in group app, launching a new machine

-------
 таз Waiting for 4d89703f452538 [app] to have state: started
```

Once that's done, you can visit the URL that Fly.io gives you and you'll see your Storyden instance.

## Necessary configuration

That's only half the story though. You have an instance but it's entirely **ephemeral**! This means that if the instance is restarted, it will lose all its data.

To ensure the SQLite database is persisted, we need to add a volume mount to the `fly.toml` configuration file. This file is generated by Fly.io when you run the `fly launch` command.

It will look something like this:

```toml
# fly.toml app configuration file generated for storyden-unique-name-1234 on 2023-12-12T23:19:17Z
#
# See https://fly.io/docs/reference/configuration/ for information about how to use this file.
#

app = "storyden-unique-name-1234"
primary_region = "lhr"

[build]
  image = "ghcr.io/southclaws/storyden"

[http_service]
  internal_port = 3000
  force_https = true
  auto_stop_machines = true
  auto_start_machines = true
  min_machines_running = 0
  processes = ["app"]

[[vm]]
  cpu_kind = "shared"
  cpus = 1
  memory_mb = 1024
```

(Note: over time the defaults may change and these docs may become slightly out of date)

We need to add a volume mount to the `[mounts]` section:

```diff
    # fly.toml app configuration file generated for storyden-unique-name-1234 on 2023-12-12T23:19:17Z
    #
    # See https://fly.io/docs/reference/configuration/ for information about how to use this file.
    #
    
    app = "storyden-unique-name-1234"
    primary_region = "lhr"
    
    [build]
      image = "ghcr.io/southclaws/storyden"
    
    [http_service]
      internal_port = 3000
      force_https = true
      auto_stop_machines = true
      auto_start_machines = true
      min_machines_running = 0
      processes = ["app"]
    
    [[vm]]
      cpu_kind = "shared"
      cpus = 1
      memory_mb = 1024
+
+   [mounts]
+     source="storyden_data"
+     destination="/data"
```

And then re-deploy the app:

```sh
fly deploy
```

And that's it! You now have your own Storyden instance running on Fly.io!
